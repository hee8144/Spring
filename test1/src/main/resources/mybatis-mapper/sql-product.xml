<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.ProductMapper">

	<select id="selectProductList" parameterType="hashmap" resultType="com.example.test1.model.Product">
		SELECT * FROM TBL_FOOD F
		INNER JOIN TBL_FOOD_IMG I ON F.FOOD_NO = I.FOOD_NO
		WHERE 1=1
		<if test="keyWord != null and keyWord !=''">
			AND FOOD_NAME LIKE '%' || #{keyWord} || '%' OR FOOD_INFO LIKE '%' || #{keyWord} || '%'
		</if>
		
		<if test="part !=null and part !=''">
			AND MENU_PART = #{part}
		</if>
		
		<if test="menuNo !=null and menuNo !='' ">
			AND MENU_No = #{menuNo}
		</if>
		
	</select>
	
	
	<select id="selectMenuList" parameterType="hashmap" resultType="com.example.test1.model.Menu">
		SELECT M.*, NVL(CNT,0) AS CNT 
		FROM TBL_MENU M
		LEFT JOIN (
		SELECT MENU_PART ,COUNT(MENU_PART) AS CNT
		FROM TBL_MENU M1
		GROUP BY MENU_PART
		)R ON M.MENU_NO = R.MENU_PART
	</select>
	
	<select id="selectAddMenuList" parameterType="hashmap" resultType="com.example.test1.model.Menu">
		SELECT M.*, NVL(CNT,0) AS CNT 
		FROM TBL_MENU M
		LEFT JOIN (
		SELECT MENU_PART ,COUNT(MENU_PART) AS CNT
		FROM TBL_MENU M1
		GROUP BY MENU_PART
		)R ON M.MENU_NO = R.MENU_PART
		WHERE DEPTH = 1
	</select>

</mapper>




